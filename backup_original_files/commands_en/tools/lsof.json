{
  "command": "lsof",
  "description": "List open files and processes using them",
  "syntax": "lsof [options] [files|processes]",
  "category": "system_info",
  "options": [
    {
      "option": "-p PID",
      "description": "Show files opened by specified process ID"
    },
    {
      "option": "-u user",
      "description": "Show files opened by specified user"
    },
    {
      "option": "-c process",
      "description": "Show files opened by specified process name"
    },
    {
      "option": "-i [protocol][:port]",
      "description": "Show network-related files"
    },
    {
      "option": "-t",
      "description": "Show only process IDs"
    },
    {
      "option": "-n",
      "description": "Show IP addresses instead of hostnames"
    },
    {
      "option": "-P",
      "description": "Show port numbers instead of service names"
    },
    {
      "option": "+D directory",
      "description": "Show files open in directory and subdirectories"
    },
    {
      "option": "-a",
      "description": "AND logic, all conditions must be met"
    }
  ],
  "examples": [
    {
      "command": "lsof /var/log/messages",
      "description": "Show which process is using this file"
    },
    {
      "command": "lsof -u root",
      "description": "Show all files opened by root user"
    },
    {
      "command": "lsof -c ssh",
      "description": "Show files opened by ssh processes"
    },
    {
      "command": "lsof -i :22",
      "description": "Show processes using port 22"
    },
    {
      "command": "lsof -i tcp:80",
      "description": "Show processes using TCP port 80"
    },
    {
      "command": "lsof -p 1234",
      "description": "Show files opened by process ID 1234"
    },
    {
      "command": "lsof +D /tmp",
      "description": "Show files opened in /tmp directory"
    }
  ],
  "related_commands": ["ps", "netstat", "ss", "fuser"],
  "tags": ["files", "process", "network", "monitoring", "debug"]
}